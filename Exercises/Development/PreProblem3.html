<!DOCTYPE html>
<html data-require="jsav math PreProblem3">
  <head>
    <title>Understanding How to Make a DFA Part 3</title>
    <script src="//cdnjs.cloudflare.com/ajax/libs/require.js/2.1.14/require.min.js"></script>
    <script src="../../khan-exercises/local-only/main.js" ></script>
    <script src="../../AV/Development/dfa.js" ></script>
     <style>
      #PreProblem3 .bgColor {
        font-size: 130%;
        background-color: yellow;
      }

      #PreProblem3 .jsavpointer {
        width: 40px;
        text-align: center;
        cursor: pointer;
      }

      #PreProblem3 .highlight {      /* For the pointer */
        background-color: yellow;
      }
    </style>
  </head>

  <body data-height="1000" data-width="950">
  	<script>
		  	var question = "";
		  	var solved = "";
		  	var arrA = [], arrB = [], jsav;
		  	
		  	var generateExp = function(){
		  		question = "";
		  			var lengths = (Math.random() * 6) + 1;
					for(var i = 0; i < lengths; i++){
						var rand = Math.floor(Math.random() + .5);
						question += rand === 0 ? "a" : "b"; 				
					}
				return question;
		  	}
		  	
		  	var generateDFA = function(){
		  		arrA = [];
		  		arrB = [];
		  		jsav = new JSAV("PreProblem3");
				var dfa = new DFA(jsav);
				var textArray = [];
				var next = 0;				
				
				var state1 = dfa.addState(1, 1, "#ffddff", true, false, 0);
				var state2 = dfa.addState(2, 2, "#ffddff", false, false, 1);
				var state3 = dfa.addState(2.5, 0, "#ffddff", false, false, 2);
				var state4 = dfa.addState(3, 1.5, "#ffddff", false, false, 3);
				var stateArr = [state1, state2, state3, state4];
				
				arrA.push(Math.floor(Math.random() * 3) + 1);
				state1.addNextState(stateArr[arrA[0]], ["a"]);
				next = Math.floor(Math.random() * 3) + 1;
				while (next == arrA[0]){
					next = Math.floor(Math.random() * 3) + 1;		
				}
				arrB.push(next);
				state1.addNextState(stateArr[arrB[0]], ["b"]);
				arrA.push(Math.floor(Math.random() * 4));
				state2.addNextState(stateArr[arrA[0]], ["a"]);
				arrB.push(Math.floor(Math.random() * 4));
				state2.addNextState(stateArr[arrB[0]], ["b"]);
				arrA.push(Math.floor(Math.random() * 4));
				state3.addNextState(stateArr[arrA[0]], ["a"]);
				arrB.push(Math.floor(Math.random() * 4));
				state3.addNextState(stateArr[arrB[0]], ["b"]);
				arrA.push(Math.floor(Math.random() * 4));
				state4.addNextState(stateArr[arrA[0]], ["a"]);
				arrB.push(Math.floor(Math.random() * 4));
				state4.addNextState(stateArr[arrB[0]], ["b"]);
				jsav.displayInit();
		  	};
		  	
		  	var solve = function(){
		  		solved = "";
		  			var exp = question; 
		  			var curPos = 0;
					for (var i = 0; i < exp.length; i++){
						curPos = newPosition(curPos, exp.charAt(i));			
					}
					if(curPos == 0){
						solved = 'Left';
					} else if (curPos == 1){
						solved = 'Bottom';
					} else if (curPos == 2){
						solved = 'Top';
					} else{
						solved = 'Right';
					}
				
				return solved;
		  	}
		  	
		  	var newPosition = function(pos, curChar){
				if (curChar == 'a'){
						return arrA[pos];
				}else{
					return arrB[pos];		
				}	  	
		  	}
		  	
  	</script>
    <div class="exercise">
    	<div class="vars">
    		<var id="Expression">generateExp()</var>
    		<var id="Solved">solve()</var>
    		<var id="JSAV">generateDFA()</var>
    	</div>
    	
      <div class="problems">
        <div id="PreProblem3p">
          <p class="question">Where does the following expression end? <var>Expression</var></p>
          <p >Note that if there is no line for a letter it stays at its current position 
          and if lines overlap the top letter always goes with the right directional line.</p>
          <div class="solution"><var>Solved</var></div>
          <ul class="choices" data-category="true">
            <li>Left</li>
            <li>Top</li>
            <li>Right</li>
            <li>Bottom</li>
          </ul>
          <div id="PreProblem3" class="jsavcanvas"></div>
        </div>
      </div>
    </div>
  </body>
</html>